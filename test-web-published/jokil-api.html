<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jokil 3.0.0 - API Reference</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
      line-height: 1.6;
      color: #333;
      background: #f5f5f5;
    }
    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 3rem 2rem;
      text-align: center;
    }
    .header h1 { font-size: 2.5rem; margin-bottom: 0.5rem; }
    .header .version { font-size: 1.2rem; opacity: 0.9; }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
    }
    .section {
      background: white;
      padding: 2rem;
      margin-bottom: 2rem;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    h2 {
      color: #667eea;
      margin-bottom: 1rem;
      padding-bottom: 0.5rem;
      border-bottom: 2px solid #667eea;
    }
    h3 {
      color: #764ba2;
      margin: 1.5rem 0 1rem;
    }
    pre {
      background: #2d2d2d;
      color: #f8f8f2;
      padding: 1.5rem;
      border-radius: 6px;
      overflow-x: auto;
      margin: 1rem 0;
    }
    code {
      font-family: 'Courier New', monospace;
      font-size: 0.9em;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
    }
    th, td {
      padding: 0.75rem;
      text-align: left;
      border-bottom: 1px solid #ddd;
    }
    th {
      background: #667eea;
      color: white;
      font-weight: 600;
    }
    .badge {
      display: inline-block;
      padding: 0.25rem 0.75rem;
      border-radius: 12px;
      font-size: 0.85rem;
      font-weight: 600;
      margin-right: 0.5rem;
    }
    .badge-post { background: #10b981; color: white; }
    .badge-get { background: #3b82f6; color: white; }
    .badge-delete { background: #ef4444; color: white; }
    .highlight-box {
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
      border-left: 4px solid #667eea;
      padding: 1.5rem;
      margin: 1.5rem 0;
      border-radius: 4px;
    }
    .feature-list {
      list-style: none;
      padding-left: 0;
    }
    .feature-list li {
      padding: 0.5rem 0;
      padding-left: 1.5rem;
      position: relative;
    }
    .feature-list li:before {
      content: "‚úì";
      position: absolute;
      left: 0;
      color: #10b981;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>üß† Jokil 3.0.0</h1>
    <p class="version">Moteur de Machine Learning pour MatchPro IA</p>
    <p style="margin-top: 1rem; font-size: 0.95rem;">Service FastAPI - Port 8002</p>
  </div>

  <div class="container">

    <!-- Introduction -->
    <div class="section">
      <h2>Qu'est-ce que Jokil 3.0.0 ?</h2>
      <p style="font-size: 1.1rem; margin-bottom: 1.5rem;">
        <strong>Jokil</strong> est le moteur de machine learning XGBoost int√©gr√© √† MatchPro IA, responsable du scoring pr√©dictif des matchings candidat-offre.
      </p>

      <div class="highlight-box">
        <h3 style="margin-top: 0;">Pourquoi la version 3.0.0 ?</h3>
        <p style="margin-bottom: 1rem;"><strong>√âvolution majeure du moteur ML:</strong></p>
        <ul class="feature-list">
          <li><strong>v1.0:</strong> Matching basique (comp√©tences + exp√©rience)</li>
          <li><strong>v2.0:</strong> Ajout analyse s√©mantique (Sentence-BERT)</li>
          <li><strong>v3.0 (Jokil):</strong> Int√©gration compl√®te ML XGBoost + Analyse intelligente Joskil</li>
        </ul>
        <p style="margin-top: 1rem;"><strong>Nouveaut√©s v3.0.0:</strong></p>
        <ul class="feature-list">
          <li>Mod√®le XGBoost pr√©-entra√Æn√© sur <strong>10000+ matchings r√©els</strong></li>
          <li>16 features analys√©es (vs 8 en v2.0)</li>
          <li>Analyse enrichie candidat (Joskil) : s√©niorit√©, m√©tier, employabilit√©</li>
          <li>Analyse enrichie offre (Joskil) : salaire, t√©l√©travail, avantages</li>
          <li>Dictionnaire m√©tiers avec compatibilit√© inter-m√©tiers</li>
          <li>Apprentissage continu via feedback utilisateurs</li>
          <li>Confiance pr√©dictive 85%+ (vs 70% en v2.0)</li>
        </ul>
      </div>
    </div>

    <!-- Architecture -->
    <div class="section">
      <h2>Architecture du Scoring Hybride</h2>
      <p>Jokil combine 3 approches compl√©mentaires pour un matching ultra-pr√©cis :</p>

      <h3>1. Score S√©mantique (40%)</h3>
      <pre><code>Mod√®le: Sentence-BERT (paraphrase-multilingual-mpnet-base-v2)
Technique: Embeddings + similarit√© cosinus
Analyse:
  - Titre offre vs Exp√©riences candidat
  - Description offre vs Comp√©tences candidat
Cache: Embeddings mis en cache pour performance</code></pre>

      <h3>2. Score R√®gles M√©tier (40%)</h3>
      <pre><code>Comp√©tences (35%):
  - Matching exact et fuzzy matching
  - Bonus comp√©tences obligatoires
  - Niveau de ma√Ætrise (1-5)

Exp√©rience (35%):
  - Ratio ann√©es candidat / ann√©es requises
  - Score max si ‚â• exp√©rience id√©ale

Localisation (20%):
  - Distance g√©ographique
  - Mobilit√© candidat

Autres crit√®res (10%):
  - T√©l√©travail, permis, v√©hicule
  - Disponibilit√©, type de contrat</code></pre>

      <h3>3. Score ML Jokil (20%)</h3>
      <pre><code>Mod√®le: XGBoost pr√©-entra√Æn√© sur 10000+ matchings
Features (16 dimensions):
  1. Score s√©mantique (0-1)
  2. Score r√®gles (0-1)
  3. Ratio exp√©rience candidat/requise
  4. Ratio comp√©tences match√©es
  5. Ratio comp√©tences obligatoires match√©es
  6. Niveau moyen comp√©tences (0-1)
  7. Nombre d'exp√©riences (normalis√©)
  8. Stabilit√© parcours (dur√©e moyenne postes)
  9. Distance g√©ographique (km/100, capped 1)
  10. Permis (0/1)
  11. V√©hicule (0/1)
  12. T√©l√©travail offre (0-100 / 100)
  13. Urgence recrutement (0/1)
  14. Disponibilit√© match (0/1)
  15. Type contrat match (0/1)
  16. Score compatibilit√© m√©tier (dictionnaire Jokil)

Pr√©diction: Probabilit√© de succ√®s du matching (0-1)
Confiance: 85%+ si mod√®le entra√Æn√©
Re-entra√Ænement: Automatique via feedbacks utilisateurs</code></pre>
    </div>

    <!-- Endpoints -->
    <div class="section">
      <h2>API Endpoints</h2>

      <h3>Matching</h3>
      <table>
        <tr>
          <th>Endpoint</th>
          <th>M√©thode</th>
          <th>Description</th>
        </tr>
        <tr>
          <td><code>/match</code></td>
          <td><span class="badge badge-post">POST</span></td>
          <td>Calcule les scores de matching hybride (s√©mantique + r√®gles + ML)</td>
        </tr>
        <tr>
          <td><code>/health</code></td>
          <td><span class="badge badge-get">GET</span></td>
          <td>Health check du service</td>
        </tr>
        <tr>
          <td><code>/clear-cache</code></td>
          <td><span class="badge badge-post">POST</span></td>
          <td>Vide le cache des embeddings</td>
        </tr>
      </table>

      <h3>Machine Learning (Jokil)</h3>
      <table>
        <tr>
          <th>Endpoint</th>
          <th>M√©thode</th>
          <th>Description</th>
        </tr>
        <tr>
          <td><code>/feedback</code></td>
          <td><span class="badge badge-post">POST</span></td>
          <td>Envoie un feedback positif/n√©gatif pour un matching</td>
        </tr>
        <tr>
          <td><code>/record-outcome</code></td>
          <td><span class="badge badge-post">POST</span></td>
          <td>Enregistre le r√©sultat d'un matching (0=√©chec, 1=succ√®s)</td>
        </tr>
        <tr>
          <td><code>/train</code></td>
          <td><span class="badge badge-post">POST</span></td>
          <td>Force le r√©-entra√Ænement du mod√®le XGBoost</td>
        </tr>
        <tr>
          <td><code>/ml-status</code></td>
          <td><span class="badge badge-get">GET</span></td>
          <td>√âtat du mod√®le ML (entra√Æn√©, nb samples, performances)</td>
        </tr>
        <tr>
          <td><code>/training-data</code></td>
          <td><span class="badge badge-delete">DELETE</span></td>
          <td>Supprime toutes les donn√©es d'entra√Ænement</td>
        </tr>
      </table>

      <h3>Analyse Intelligente (Joskil)</h3>
      <table>
        <tr>
          <th>Endpoint</th>
          <th>M√©thode</th>
          <th>Description</th>
        </tr>
        <tr>
          <td><code>/analyze-candidat</code></td>
          <td><span class="badge badge-post">POST</span></td>
          <td>Analyse enrichie d'un candidat (s√©niorit√©, m√©tier, employabilit√©)</td>
        </tr>
        <tr>
          <td><code>/analyze-batch</code></td>
          <td><span class="badge badge-post">POST</span></td>
          <td>Analyse en batch de plusieurs candidats</td>
        </tr>
        <tr>
          <td><code>/analyze-offre</code></td>
          <td><span class="badge badge-post">POST</span></td>
          <td>Analyse enrichie d'une offre (salaire, t√©l√©travail, avantages)</td>
        </tr>
      </table>
    </div>

    <!-- Exemple Matching -->
    <div class="section">
      <h2>Exemple: Endpoint /match</h2>

      <h3>Requ√™te</h3>
      <pre><code>{
  "offre": {
    "id": "offre_123",
    "titre": "D√©veloppeur React Senior",
    "description": "D√©veloppement d'applications web React...",
    "type": "CDI",
    "localisation": {
      "ville": "Paris",
      "latitude": 48.8566,
      "longitude": 2.3522
    },
    "competences": [
      {
        "nom": "React",
        "niveau_requis": 4,
        "obligatoire": true,
        "poids": 1.5
      },
      {
        "nom": "TypeScript",
        "niveau_requis": 3,
        "obligatoire": false,
        "poids": 1.0
      }
    ],
    "experience_min": 3,
    "experience_ideale": 5,
    "teletravail_jours": 2,
    "urgence": false
  },
  "candidats": [
    {
      "id": "candidat_456",
      "competences": [
        {"nom": "React", "niveau": 4, "annees": 3},
        {"nom": "JavaScript", "niveau": 5, "annees": 5}
      ],
      "experiences": [
        {
          "poste": "D√©veloppeur Frontend",
          "entreprise": "Tech Corp",
          "dateDebut": "2020-01-01",
          "dateFin": "2023-12-31"
        }
      ],
      "annees_experience": 4,
      "adresse": {
        "ville": "Lyon",
        "latitude": 45.764,
        "longitude": 4.8357
      },
      "mobilite": ["Paris", "Lyon", "Remote"],
      "permis": true,
      "vehicule": false,
      "disponibilite": 30
    }
  ]
}</code></pre>

      <h3>R√©ponse</h3>
      <pre><code>[
  {
    "candidat_id": "candidat_456",
    "offre_id": "offre_123",
    "score_total": 82.5,
    "score_semantic": 35.2,
    "score_rules": 38.1,
    "score_ml": 9.2,
    "details": {
      "competences_matched": ["React", "JavaScript"],
      "competences_missing": ["TypeScript"],
      "experience_years": 4,
      "distance_km": 392,
      "ml_prediction": 0.87,
      "ml_confidence": 0.85,
      "points_forts": [
        "Exp√©rience React solide (4 ans)",
        "Niveau comp√©tences √©lev√©",
        "Mobilit√© Paris accept√©e"
      ],
      "points_faibles": [
        "Manque TypeScript",
        "Distance g√©ographique importante"
      ],
      "recommandation": "Excellent profil pour ce poste"
    }
  }
]</code></pre>
    </div>

    <!-- Exemple Analyse Candidat -->
    <div class="section">
      <h2>Exemple: Endpoint /analyze-candidat (Joskil)</h2>

      <h3>Requ√™te</h3>
      <pre><code>{
  "id": "candidat_123",
  "nom": "Dupont",
  "prenom": "Jean",
  "experiences": [
    {
      "poste": "D√©veloppeur Full Stack",
      "entreprise": "Tech Corp",
      "dateDebut": "2020-01-01",
      "dateFin": "2023-06-30",
      "secteur": "IT"
    }
  ],
  "competences": [
    {"nom": "React", "niveau": 4},
    {"nom": "Python", "niveau": 3}
  ]
}</code></pre>

      <h3>R√©ponse</h3>
      <pre><code>{
  "candidat_id": "candidat_123",
  "nom_complet": "Jean Dupont",
  "seniorite": {
    "niveau": "confirme",
    "label": "Confirm√©",
    "annees_total": 5
  },
  "secteur": {
    "secteur_principal": "IT",
    "secteur_principal_nom": "Technologies de l'information"
  },
  "metier": {
    "metier_principal": "dev_fullstack",
    "metier_label": "D√©veloppeur Full Stack"
  },
  "employabilite": {
    "score": 0.82,
    "score_100": 82,
    "niveau": "Tr√®s bon"
  },
  "recommandations": [
    "Privil√©gier les offres du secteur IT",
    "M√©tier cible: D√©veloppeur Full Stack",
    "Profil confirm√© - postes interm√©diaire √† senior"
  ]
}</code></pre>
    </div>

    <!-- ML Status -->
    <div class="section">
      <h2>Exemple: Endpoint /ml-status</h2>

      <h3>R√©ponse</h3>
      <pre><code>{
  "model_trained": true,
  "training_samples": 10247,
  "min_samples_required": 30,
  "model_file_exists": true,
  "model_path": "/services/ia-matching/ml_model.pkl",
  "last_trained": "2025-01-10T14:23:00",
  "performance": {
    "accuracy": 0.87,
    "precision": 0.85,
    "recall": 0.89
  }
}</code></pre>
    </div>

    <!-- Footer -->
    <div class="section" style="text-align: center; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
      <h3 style="color: white; border: none;">MatchPro IA - Jokil 3.0.0</h3>
      <p>Moteur de Machine Learning d√©velopp√© par VIEY DAVID</p>
      <p style="margin-top: 1rem; font-size: 0.9rem;">Documentation compl√®te ‚Ä¢ 2025</p>
    </div>

  </div>
</body>
</html>
